<div class="creditor">
  <p-toast></p-toast>
  <p-panel header="{{'Πίνακας φοιτητών'}}" [toggleable]="true">
    <p-table #dt [loading]="isLoading" [showLoader]="false"
             responsiveLayout="scroll"
             [value]="students" [rows]="10" [paginator]="true"
             [globalFilterFields]="['name','creditor.name']"
             [rowHover]="true" dataKey="id"
             currentPageReportTemplate="{{'Εμφάνιση'}} {first} {{'έως'}} {last} {{'από'}} {totalRecords} {{'φοιτητές'}}"
             [showCurrentPageReport]="true">
      <ng-template pTemplate="header">
        <tr>
          <th style="display: none;">id</th>
          <th pSortableColumn="name">{{'Επώνυμο'}}
            <p-sortIcon field="surname"></p-sortIcon>
          </th>
          <th pSortableColumn="name">{{'Όνομα'}}
            <p-sortIcon field="name"></p-sortIcon>
          </th>
          <th pSortableColumn="name">{{'email'}}
            <p-sortIcon field="email"></p-sortIcon>
          </th>
          <th pSortableColumn="name">{{'Ημ/νια εγγραφής'}}
            <p-sortIcon field="dateCreated"></p-sortIcon>
          </th>
          <th pSortableColumn="name">{{'Τμήμα'}}
            <p-sortIcon field="direction"></p-sortIcon>
          </th>
          <th pSortableColumn="isVerified">{{'Ενεργός'}}
            <p-sortIcon field="isVerified"></p-sortIcon>
          </th>
          <th></th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-student let-columns="columns">
        <tr>
          <td style="display: none;">{{student.id}}</td>
          <td>{{student.surname}}</td>
          <td>{{student.name}}</td>
          <td>{{student.email}}</td>
          <td>{{student.dateCreated | date}}</td>
          <td>{{student.direction.name}}</td>
          <td>
            <span *ngIf="student.isVerified"><i class="pi true-icon pi-check-circle"
                                                style="font-size: 1.5rem"></i></span>
            <span *ngIf="!student.isVerified"><i class="pi false-icon pi-times-circle"
                                                 style="font-size: 1.5rem"></i></span>
          </td>
          <td>
            <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-warning p-button-outlined mr-2"
                    (click)="editCreditor(student)"></button>
            <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-danger p-button-outlined"
                    (click)="deleteCreditor(student)"></button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="loadingbody" let-columns="columns">
        <tr>
          <td>
            <p-skeleton></p-skeleton>
          </td>
          <td>
            <p-skeleton></p-skeleton>
          </td>
          <td>
            <p-skeleton></p-skeleton>
          </td>
        </tr>
        <tr>
          <td>
            <p-skeleton></p-skeleton>
          </td>
          <td>
            <p-skeleton></p-skeleton>
          </td>
          <td>
            <p-skeleton></p-skeleton>
          </td>
        </tr>
        <tr>
          <td>
            <p-skeleton></p-skeleton>
          </td>
          <td>
            <p-skeleton></p-skeleton>
          </td>
          <td>
            <p-skeleton></p-skeleton>
          </td>
        </tr>
        <tr>
          <td>
            <p-skeleton></p-skeleton>
          </td>
          <td>
            <p-skeleton></p-skeleton>
          </td>
          <td>
            <p-skeleton></p-skeleton>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </p-panel>

</div>

<p-dialog [(visible)]="newCreditorDialog" [style]="{width: '450px'}"
          [modal]="true" styleClass="p-fluid"
          (onHide)="hideCreditorDialog()">
  <ng-template pTemplate="header">
    <span *ngIf="editable && !deleteCr">{{'Επεξεργασία φοιτητή'}}</span>
    <span *ngIf="deleteCr">{{'CREDITORS.DELETE_CREDITOR'}}</span>
  </ng-template>

  <p-messages [(value)]="formErrors" [enableService]="false"></p-messages>
  <form [formGroup]="studentForm">
    <!--    <label *ngIf="!deleteCr">{{'Ενεργός'}}</label>-->
    <!--    <input *ngIf="!deleteCr" type="text" pInputText id="name" class="p-inputtext-md p-inputtext" formControlName="name">-->
    <!--    <div *ngIf="name.invalid && (name.dirty || name.touched)">-->
    <!--      <small *ngIf="name.errors?.['required']" class="text-danger">{{"THIS_FIELD_IS_REQUIRED"}}.</small>-->
    <!--    </div>-->
    <div *ngIf="editable && !deleteCr" class="mt-3 mb-3 form-group editableContainer">
      <p-toggleButton onIcon="pi pi-check"
                      offIcon="pi pi-times" formControlName="isVerified">
      </p-toggleButton>
      <label>{{'Ενεργός'}}</label>
    </div>
    <p *ngIf="deleteCr">{{{name: name.value} }}</p>
    <div class="p-dialog-footer">
      <button pButton pRipple label="{{'Ακύρωση'}}" icon="pi pi-times" class="p-button-text"
              (click)="hideCreditorDialog()"></button>
      <button *ngIf="editable && !deleteCr" pButton pRipple label="{{'Ενημέρωση'}}" icon="pi pi-pencil"
              class="p-button-text" (click)="updateCreditor()"></button>
      <button *ngIf="deleteCr" pButton pRipple label="{{'Διαγραφή'}}" icon="pi pi-trash"
              class="p-button-text p-button-danger" (click)="removeCreditor()"></button>
    </div>
  </form>
</p-dialog>
